<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <link rel="stylesheet" href="css/animate.css">
  <title>mobile-photo-demo</title>
  <style>
  /* 默认样式初始化 */
  body, button, dd, dl, dt, fieldset, form, h1, h2, h3, h4, h5, h6, hr, input, legend, li, ol, p, pre, td, textarea, th, ul,img{
    margin: 0;
    padding: 0;
    }
  body{
    background-color: #000;
    overflow: hidden;
    /*去掉托拖拽的栏 显示为4列  */
  }
  ul{
    list-style: none;
  }
  li{
    width: 100px;
    height: 100px;
    float: left;
    overflow: hidden;

  }
  .img-container{

  }
  .large{
    width: 100%;
    height: 100%;
    background-color: #000;
    display: none;
    position: absolute;
    top: 0;
    left: 0;
  }

  </style>
</head>
<script src="js/zepto.min.js"></script>
<body>
  <ul id="container" class="img-container">
    <!--  //dom加载图片
    <li><img src="img/1.jpg" height="220" width="352" alt=""></li> -->

  </ul>

  <div class="large">
    <div id="large_img">

    </div>
  </div>
</body>
<script>
  var total = 17;
  var zWin = $(window);
  var render = function(){
    var padding = 2;
    var winWidth = zWin.width();
    //窗口的宽度
    var picWidth = Math.floor((winWidth-padding*3)/4);
    //让图片显示为屏幕的1/4 包含padding
    var tmpl = '';
    for(var i=1;i<=total;i++){
      var p = padding;
      var imgSrc = 'img/'+i+'.jpg';
      if(i%4==0){
        p = 0;
      }
       /*tmpl +='<li style="width:'+picWidth+'px;padding-left:'+p+'px;height:'+picWidth+'px; padding-top:'+padding+'px"><img src="'+imgSrc+'" /></li>'*/
       /*以上使用image标签会占用dom资源*/
       tmpl +='<li data-id="'+i+'" class = "animated rotateInDownRight" style="width:'+picWidth+'px;padding-left:'+p+'px;height:'+picWidth+'px; padding-top:'+padding+'px"><canvas id = "cvs_'+i+'"></canvas></li>'
       //调用animate动画库
       // var imageObj = new Image();
       //等图片加载完成后触发事件
       imageObj.index =i;
       imageObj.onload = function(){
          var cvs = $('#cvs_'+this.index)[0].getContext("2d")
           cvs.width = this.width;
           cvs.height = this.height;
           cvs.drawImage(this,0,0);

       }
       imageObj.src = imgSrc;
    }
    $('#container').html(tmpl)
  }
  render();

/*小图效果*/

var wImage = $('#large_img');
//给大图容器赋值
var loadImg = function(id){
  $('#large_container').css({
    width:zWin.width(),
    height:zWin.height()

  }).show();
  var imgsrc = 'img/'+id+'.large.jpg';
  // var imageObj = new Image():
  //当图片加载完成过后设置属性
  ImageObj.onload =function(){
    var w = this.width;
    var h = this.height;
    var winWidth = zWin.width():
    var winHeight = zWin.height():

    //获得图片真实高宽
    var realw = winHeight*w/h;
    var paddingLeft = parseInt((winWidth-realw)/2);
    var realh = winWidth*h/w;
    var paddingTop  =parseInt((winHeight-realh)/2);


    //判断图片长图还是宽图
    if(h/w>1.2){
      //如果是长图  就设置图片高度等于视窗高度  宽度加上padding
      wImage.attr('src',imgsrc).css('height',winHeight).css('padding-left',paddingLeft)
    }else{
      wImage.attr('src',imgsrc).css('width',winWidth).css('padding-top',paddingTop)
    }

  }

  imageObj.src = imgsrc;
}



  //委托事件给li 点击加载大图
$("#container").delegate('li','tap',function(){
  var _id = $(this).attr('data-id')
  loadImg(_id);
})


</script>
</html>





